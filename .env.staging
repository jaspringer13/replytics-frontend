# ===========================================
# REPLYTICS STAGING ENVIRONMENT CONFIGURATION
# ===========================================
# This file contains all environment variables required for staging deployment
# Staging should mirror production but with test/development services

# ===========================================
# APPLICATION CONFIGURATION
# ===========================================
NODE_ENV=staging
NEXT_PUBLIC_APP_URL=https://staging.replytics.com
NEXT_PUBLIC_API_URL=https://staging-api.replytics.com
NEXT_PUBLIC_BACKEND_API_URL=https://staging-voice-bot.replytics.com

# Build Configuration
BUILD_STANDALONE=false
ANALYZE=false
NEXT_PHASE=phase-development-server

# ===========================================
# DATABASE CONFIGURATION
# ===========================================

# Voice-Bot PostgreSQL (Staging Database)
VOICE_BOT_DB_HOST=staging-postgres.replytics.com
VOICE_BOT_DB_PORT=5432
VOICE_BOT_DB_NAME=replytics_staging
VOICE_BOT_DB_USER=replytics_staging
VOICE_BOT_DB_PASSWORD=[STAGING_DB_PASSWORD]
VOICE_BOT_DB_SSL=require
VOICE_BOT_DB_POOL_MIN=2
VOICE_BOT_DB_POOL_MAX=10
VOICE_BOT_DB_CONNECTION_TIMEOUT=30000
VOICE_BOT_DB_IDLE_TIMEOUT=600000
VOICE_BOT_DB_MAX_RETRIES=3
VOICE_BOT_DB_RETRY_DELAY=1000

# Supabase Configuration (Staging Project)
NEXT_PUBLIC_SUPABASE_URL=https://[STAGING_PROJECT_ID].supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=[STAGING_SUPABASE_ANON_KEY]
SUPABASE_SERVICE_ROLE_KEY=[STAGING_SUPABASE_SERVICE_ROLE_KEY]
SUPABASE_JWT_SECRET=[STAGING_SUPABASE_JWT_SECRET]
DATABASE_URL=postgres://postgres:[PASSWORD]@db.[STAGING_PROJECT_ID].supabase.co:6543/postgres

# ===========================================
# AUTHENTICATION & SECURITY
# ===========================================

# NextAuth Configuration
NEXTAUTH_URL=https://staging.replytics.com
NEXTAUTH_SECRET=[STAGING_NEXTAUTH_SECRET]
JWT_SECRET_KEY=[STAGING_JWT_SECRET_KEY]
SESSION_ENCRYPTION_KEY=[STAGING_SESSION_ENCRYPTION_KEY]

# Google OAuth (Test Credentials)
GOOGLE_CLIENT_ID=[STAGING_GOOGLE_CLIENT_ID]
GOOGLE_CLIENT_SECRET=[STAGING_GOOGLE_CLIENT_SECRET]

# Voice Agent Authentication
VOICE_AGENT_AUTH_KEY=[STAGING_VOICE_AGENT_AUTH_KEY]

# Business ID Resolution Cache (Shorter TTL for testing)
BUSINESS_ID_CACHE_TTL=60
BUSINESS_ID_CACHE_MAX_SIZE=1000

# Security Headers (Same as production)
SECURITY_HEADERS_ENABLED=true
CSRF_PROTECTION_ENABLED=true
XSS_PROTECTION_ENABLED=true
CONTENT_SECURITY_POLICY_ENABLED=true

# ===========================================
# VOICE SERVICES INTEGRATION (TEST APIS)
# ===========================================

# ElevenLabs Voice Synthesis (Test API)
ELEVENLABS_API_KEY=[STAGING_ELEVEN_LABS_API_KEY]
ELEVEN_LABS_VOICE_STABILITY=0.75
ELEVEN_LABS_VOICE_SIMILARITY=0.85
DEFAULT_VOICE_ID=kdmDKE6EkgrWrrykO9Qt

# Deepgram Speech-to-Text (Test API)
DEEPGRAM_API_KEY=[STAGING_DEEPGRAM_API_KEY]
DEEPGRAM_MODEL=nova-2
DEEPGRAM_LANGUAGE=en-US
DEEPGRAM_PUNCTUATE=true
DEEPGRAM_DIARIZE=true

# OpenAI Integration (Test API with limits)
OPENAI_API_KEY=[STAGING_OPENAI_API_KEY]
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=1000
OPENAI_TEMPERATURE=0.7
OPENAI_TOP_P=1.0
OPENAI_FREQUENCY_PENALTY=0.0
OPENAI_PRESENCE_PENALTY=0.0

# Twilio Phone Services (Test Numbers)
TWILIO_ACCOUNT_SID=[STAGING_TWILIO_ACCOUNT_SID]
TWILIO_AUTH_TOKEN=[STAGING_TWILIO_AUTH_TOKEN]
TWILIO_PHONE_NUMBER=[STAGING_TWILIO_PHONE_NUMBER]
TWILIO_WEBHOOK_URL=https://staging-voice-bot.replytics.com/webhook/twilio

# ===========================================
# CACHING & PERFORMANCE
# ===========================================

# Redis Configuration (Staging Instance)
REDIS_URL=redis://staging-redis.replytics.com:6379
REDIS_PASSWORD=[STAGING_REDIS_PASSWORD]
REDIS_DB=0
REDIS_KEY_PREFIX=replytics:staging:
REDIS_CONNECTION_TIMEOUT=5000
REDIS_RETRY_ATTEMPTS=3

# Cache TTL Settings (Shorter for testing)
CACHE_TTL_ANALYTICS=120         # 2 minutes
CACHE_TTL_BUSINESS_CONTEXT=60   # 1 minute  
CACHE_TTL_USER_SESSION=600      # 10 minutes
CACHE_TTL_QUERY_RESULTS=30      # 30 seconds
CACHE_TTL_VOICE_SETTINGS=300    # 5 minutes

# React Query Configuration (More aggressive for testing)
NEXT_PUBLIC_QUERY_STALE_TIME=60000       # 1 minute
NEXT_PUBLIC_QUERY_GC_TIME=120000         # 2 minutes
NEXT_PUBLIC_PERFORMANCE_METRICS_TIMEOUT=5000
MAX_PERFORMANCE_METRICS=500

# ===========================================
# MONITORING & LOGGING
# ===========================================

# Sentry Error Tracking (Staging Project)
SENTRY_DSN=[STAGING_SENTRY_DSN]
SENTRY_ENVIRONMENT=staging
SENTRY_TRACES_SAMPLE_RATE=1.0    # Full tracing in staging
SENTRY_PROFILES_SAMPLE_RATE=1.0  # Full profiling in staging
SENTRY_RELEASE=[STAGING_RELEASE_VERSION]

# Logging Configuration (Verbose for debugging)
LOG_LEVEL=debug
LOG_FORMAT=json
LOG_FILE_ENABLED=true
LOG_FILE_PATH=/var/log/replytics/staging-app.log
LOG_RETENTION_DAYS=7
LOG_MAX_FILE_SIZE=50MB
LOG_MAX_FILES=5

# Performance Monitoring (Enhanced for testing)
ENABLE_PERFORMANCE_MONITORING=true
PERFORMANCE_MONITORING_ENABLED=true
PERFORMANCE_SLOW_QUERY_THRESHOLD=500
PERFORMANCE_MEMORY_THRESHOLD=256
PERFORMANCE_SAMPLE_RATE=1.0

# ===========================================
# RATE LIMITING & SECURITY
# ===========================================

# Rate Limiting (More relaxed for testing)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=300000     # 5 minutes
RATE_LIMIT_MAX_REQUESTS=2000
RATE_LIMIT_BURST_MAX=300
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# API Rate Limits (Higher for testing)
RATE_LIMIT_ANALYTICS_MAX=500
RATE_LIMIT_VOICE_SETTINGS_MAX=200
RATE_LIMIT_BUSINESS_PROFILE_MAX=1000

# DDoS Protection (Relaxed for testing)
DDOS_PROTECTION_ENABLED=true
MAX_CONCURRENT_REQUESTS=1000
REQUEST_TIMEOUT_MS=60000

# ===========================================
# PAYMENT & BILLING (TEST MODE)
# ===========================================

# Stripe Configuration (Test Mode)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=[STAGING_STRIPE_PUBLISHABLE_KEY]
STRIPE_SECRET_KEY=[STAGING_STRIPE_SECRET_KEY]
STRIPE_WEBHOOK_SECRET=[STAGING_STRIPE_WEBHOOK_SECRET]

# Stripe Price IDs (Test Products)
STRIPE_STARTER_PRICE_ID=[STAGING_STARTER_PRICE_ID]
STRIPE_PROFESSIONAL_PRICE_ID=[STAGING_PROFESSIONAL_PRICE_ID]
STRIPE_ENTERPRISE_PRICE_ID=[STAGING_ENTERPRISE_PRICE_ID]

# ===========================================
# EXTERNAL INTEGRATIONS (TEST APIS)
# ===========================================

# Calendar Integration (Test Apps)
GOOGLE_CALENDAR_CLIENT_ID=[STAGING_GOOGLE_CALENDAR_CLIENT_ID]
GOOGLE_CALENDAR_CLIENT_SECRET=[STAGING_GOOGLE_CALENDAR_CLIENT_SECRET]
OUTLOOK_CLIENT_ID=[STAGING_OUTLOOK_CLIENT_ID]
OUTLOOK_CLIENT_SECRET=[STAGING_OUTLOOK_CLIENT_SECRET]

# CRM Integration (Test/Sandbox)
SALESFORCE_CLIENT_ID=[STAGING_SALESFORCE_CLIENT_ID]
SALESFORCE_CLIENT_SECRET=[STAGING_SALESFORCE_CLIENT_SECRET]
HUBSPOT_API_KEY=[STAGING_HUBSPOT_API_KEY]

# Email Services (Test Mode)
SENDGRID_API_KEY=[STAGING_SENDGRID_API_KEY]
SENDGRID_FROM_EMAIL=staging@replytics.com
POSTMARK_API_KEY=[STAGING_POSTMARK_API_KEY]

# SMS Services (Test Mode)
MESSAGEBIRD_API_KEY=[STAGING_MESSAGEBIRD_API_KEY]
AWS_SNS_ACCESS_KEY_ID=[STAGING_AWS_SNS_ACCESS_KEY_ID]
AWS_SNS_SECRET_ACCESS_KEY=[STAGING_AWS_SNS_SECRET_ACCESS_KEY]
AWS_SNS_REGION=us-east-1

# ===========================================
# FEATURE FLAGS & CONFIGURATION
# ===========================================

# Analytics Features (All enabled for testing)
ANALYTICS_REAL_TIME_ENABLED=true
ANALYTICS_EXPORT_ENABLED=true
ANALYTICS_HISTORICAL_RETENTION_DAYS=90
ANALYTICS_ADVANCED_METRICS_ENABLED=true

# Voice Features (All enabled for testing)
VOICE_AI_ENABLED=true
VOICE_TRANSCRIPTION_ENABLED=true
VOICE_SYNTHESIS_ENABLED=true
VOICE_EMOTION_DETECTION_ENABLED=true  # Enable experimental features
VOICE_LANGUAGE_DETECTION_ENABLED=true

# Integration Features (All enabled for testing)
INTEGRATION_CALENDAR_ENABLED=true
INTEGRATION_CRM_ENABLED=true
INTEGRATION_WEBHOOK_ENABLED=true
INTEGRATION_EMAIL_ENABLED=true
INTEGRATION_SMS_ENABLED=true

# Business Features (All enabled for testing)
MULTI_PHONE_SUPPORT_ENABLED=true
ADVANCED_ROUTING_ENABLED=true
CUSTOM_VOICE_TRAINING_ENABLED=true  # Enable experimental features
REAL_TIME_COACHING_ENABLED=true

# ===========================================
# DEVELOPMENT & DEBUGGING (ENHANCED)
# ===========================================

# Development Tools (Enabled in Staging)
ENABLE_SOURCEMAPS=true
REACT_QUERY_DEVTOOLS_ENABLED=true
REDUX_DEVTOOLS_ENABLED=true

# Debug Configuration (Enhanced for testing)
DEBUG_ENABLED=true
VERBOSE_LOGGING=true
PERFORMANCE_PROFILING=true

# API Documentation (Enabled)
API_DOCS_ENABLED=true
SWAGGER_UI_ENABLED=true

# ===========================================
# TESTING & QA CONFIGURATION
# ===========================================

# Test Data Configuration
TEST_DATA_ENABLED=true
SEED_TEST_DATA=true
MOCK_EXTERNAL_APIS=false

# Automated Testing
E2E_TESTING_ENABLED=true
INTEGRATION_TESTING_ENABLED=true
LOAD_TESTING_ENABLED=true

# QA Features
ERROR_SIMULATION_ENABLED=true
CHAOS_TESTING_ENABLED=false
A_B_TESTING_ENABLED=true

# ===========================================
# INFRASTRUCTURE CONFIGURATION
# ===========================================

# Load Balancer (Staging specific)
LOAD_BALANCER_HEALTH_CHECK_PATH=/api/health
LOAD_BALANCER_TIMEOUT=60000

# CDN Configuration (Staging CDN)
CDN_DOMAIN=staging-cdn.replytics.com
CDN_CACHE_CONTROL=public, max-age=3600

# SSL/TLS Configuration (Staging certs)
SSL_CERT_PATH=/etc/ssl/certs/staging.replytics.com.crt
SSL_KEY_PATH=/etc/ssl/private/staging.replytics.com.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# Container Configuration (Lower resources)
CONTAINER_PORT=3000
CONTAINER_HEALTH_CHECK_PORT=3001
CONTAINER_MEMORY_LIMIT=1024
CONTAINER_CPU_LIMIT=500

# ===========================================
# BACKUP & DISASTER RECOVERY
# ===========================================

# Database Backup (Staging)
DB_BACKUP_ENABLED=true
DB_BACKUP_SCHEDULE=0 4 * * *  # Daily at 4 AM
DB_BACKUP_RETENTION_DAYS=7
DB_BACKUP_S3_BUCKET=replytics-backups-staging
DB_BACKUP_S3_REGION=us-east-1

# Application Backup
APP_BACKUP_ENABLED=false  # Not critical for staging
CONFIG_BACKUP_ENABLED=true

# ===========================================
# COMPLIANCE & AUDIT (TESTING)
# ===========================================

# GDPR Compliance (Testing mode)
GDPR_COMPLIANCE_ENABLED=true
DATA_RETENTION_POLICY_DAYS=30  # Shorter for staging
COOKIE_CONSENT_REQUIRED=false  # Skip for easier testing

# HIPAA Compliance (Disabled in staging)
HIPAA_COMPLIANCE_ENABLED=false
PHI_ENCRYPTION_ENABLED=false
AUDIT_LOGGING_ENABLED=true

# SOC 2 Compliance (Testing)
SOC2_COMPLIANCE_ENABLED=false
ACCESS_LOGGING_ENABLED=true
CHANGE_MANAGEMENT_LOGGING=true

# ===========================================
# WEBHOOKS & NOTIFICATIONS
# ===========================================

# Webhook Configuration (Relaxed timeouts)
WEBHOOK_TIMEOUT_MS=30000
WEBHOOK_RETRY_ATTEMPTS=5
WEBHOOK_RETRY_DELAY_MS=2000
WEBHOOK_SECRET_KEY=[STAGING_WEBHOOK_SECRET]

# Notification Services (Staging channels)
SLACK_WEBHOOK_URL=[STAGING_SLACK_WEBHOOK_URL]
DISCORD_WEBHOOK_URL=[STAGING_DISCORD_WEBHOOK_URL]
EMAIL_ALERTS_ENABLED=true
SMS_ALERTS_ENABLED=false

# ===========================================
# ENVIRONMENT VALIDATION
# ===========================================

# Required Environment Variables Check
ENV_VALIDATION_ENABLED=true
ENV_VALIDATION_STRICT=false  # Relaxed for staging
ENV_VALIDATION_LOG_MISSING=true

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=15000  # More frequent checks
HEALTH_CHECK_TIMEOUT=10000
HEALTH_CHECK_RETRIES=5

# Startup Validation (Enhanced)
STARTUP_VALIDATION_ENABLED=true
STARTUP_DB_CONNECTION_CHECK=true
STARTUP_REDIS_CONNECTION_CHECK=true
STARTUP_EXTERNAL_API_CHECK=true

# ===========================================
# STAGING-SPECIFIC NOTES
# ===========================================

# 1. This environment should closely mirror production
# 2. Use test/sandbox APIs where available
# 3. Enhanced logging and monitoring for debugging
# 4. All experimental features should be tested here first
# 5. Data retention policies are shorter for cost management
# 6. More relaxed rate limiting for testing scenarios
# 7. Enable all debugging and development tools
# 8. Use staging-specific notification channels
# 9. Test backup and recovery procedures regularly
# 10. Validate all integrations before promoting to production